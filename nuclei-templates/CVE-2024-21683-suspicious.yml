id: CVE-2024-21683-suspicious

info:
  name: Atlassian Confluence Data Center and Server - Remote Code Execution
  author: pdresearch and xh4vm
  severity: high
  description: |
    Данная уязвимость позволяет авторизованному пользователю с наличием глобального права доступа System Administrator осуществить выполнение произвольного кода.
  reference:
    - https://confluence.atlassian.com/security/security-bulletin-may-21-2024-1387867145.html
    - https://realalphaman.substack.com/p/quick-note-about-cve-2024-21683-authenticated
    - https://nvd.nist.gov/vuln/detail/CVE-2024-21683
    - https://jira.atlassian.com/browse/CONFSERVER-95832
    - https://m.freebuf.com/vuls/402197.html
    - https://forum.butian.net/share/3062
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 8.3
    cve-id: CVE-2024-21683
    cwe-id: CWE-78
    epss-score: 0.00043
    epss-percentile: 0.0866
  metadata:
    verified: true
    fofa-query: app="ATLASSIAN-Confluence"
  tags: cve,cve2024,atlassian,confluence,rce,authenticated,suspicious

http:
  - method: GET
    path:
      - "{{BaseURL}}/login.action"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Confluence"
          - "ajs-version-number"
        condition: and

      - type: status
        status:
          - 200
      
      - type: regex
        part: body
        regex:
          - (?:(?:<meta\s+name=['\"]ajs-version-number['\"] content=['\"])|(?:<span\s+id=['\"]footer-build-information['\"]>)|(?:Atlassian\s+Confluence\s+))(?:(?:8.9.0)|(?:8.8.[0-1])|(?:8.7.[1-2])|(?:8.6.[0-2])|(?:8.5.[0-8])|(?:8.4.[0-5])|(?:8.3.[0-4])|(?:8.2.[0-3])|(?:8.1.[0-4])|(?:8.0.[0-4])|(?:7.20.[0-3])|(?:7.19.[0-21]))['\"<]
        condition: or